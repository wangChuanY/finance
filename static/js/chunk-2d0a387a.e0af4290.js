(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0a387a"],{"0323":function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",{staticClass:"filter-container",staticStyle:{"margin-bottom":"20px"}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("新增商品")]),r("el-button",{attrs:{type:"success",icon:"el-icon-refresh"},on:{click:e.getList}},[e._v("刷新")])],1),r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","highlight-current-row":""}},[r("el-table-column",{attrs:{label:"ID",prop:"id",align:"center",width:"80"}}),r("el-table-column",{attrs:{label:"商品名称",prop:"name",align:"center"}}),r("el-table-column",{attrs:{label:"价格",prop:"price",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v("¥ "+e._s(t.row.price))])]}}])}),r("el-table-column",{attrs:{label:"库存",prop:"stock",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-tag",{attrs:{type:t.row.stock<10?"danger":"success"}},[e._v(" "+e._s(t.row.stock)+" ")])]}}])}),r("el-table-column",{attrs:{label:"创建时间",prop:"created_at",align:"center",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(e.parseTime(t.row.created_at)))])]}}])}),r("el-table-column",{attrs:{label:"操作",align:"center",width:"230","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-edit"},on:{click:function(r){return e.handleUpdate(t.row)}}},[e._v(" 修改 ")]),r("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete"},on:{click:function(r){return e.handleDelete(t.row)}}},[e._v(" 删除 ")])]}}])})],1),r("div",{staticClass:"pagination-container",staticStyle:{"margin-top":"20px","text-align":"right"}},[r("el-pagination",{attrs:{"current-page":e.queryParams.pageNum,"page-sizes":[10,20,30,50],"page-size":e.queryParams.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"update:currentPage":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:current-page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:pageSize":function(t){return e.$set(e.queryParams,"pageSize",t)},"update:page-size":function(t){return e.$set(e.queryParams,"pageSize",t)},"size-change":e.getList,"current-change":e.getList}})],1),r("el-dialog",{attrs:{title:e.title,visible:e.open,width:"500px","append-to-body":""},on:{"update:visible":function(t){e.open=t}}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[r("el-form-item",{attrs:{label:"商品名称",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入商品名称"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),r("el-form-item",{attrs:{label:"商品价格",prop:"price"}},[r("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,precision:2,step:.1},model:{value:e.form.price,callback:function(t){e.$set(e.form,"price",t)},expression:"form.price"}})],1),r("el-form-item",{attrs:{label:"库存数量",prop:"stock"}},[r("el-input-number",{staticStyle:{width:"100%"},attrs:{min:0,step:1},model:{value:e.form.stock,callback:function(t){e.$set(e.form,"stock",t)},expression:"form.stock"}})],1)],1),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),r("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},n=[],i=r("5530"),s=r("c14f"),o=r("1da1"),c=(r("b0c0"),r("ac1f"),r("5319"),r("a8f6")),l={name:"ProductHelper",data:function(){return{loading:!0,total:0,list:[],title:"",open:!1,queryParams:{pageNum:1,pageSize:10},form:{},rules:{name:[{required:!0,message:"商品名称不能为空",trigger:"blur"}],price:[{required:!0,message:"价格不能为空",trigger:"blur"}],stock:[{required:!0,message:"库存不能为空",trigger:"blur"}]}}},created:function(){this.getList()},methods:{getList:function(){var e=this;return Object(o["a"])(Object(s["a"])().m((function t(){var r,a,n,i,o,l,u;return Object(s["a"])().w((function(t){while(1)switch(t.p=t.n){case 0:return e.loading=!0,t.p=1,r=(e.queryParams.pageNum-1)*e.queryParams.pageSize,a=r+e.queryParams.pageSize-1,t.n=2,c["a"].from("products").select("*",{count:"exact"}).order("id",{ascending:!1}).range(r,a);case 2:if(n=t.v,i=n.data,o=n.count,l=n.error,!l){t.n=3;break}throw l;case 3:e.list=i,e.total=o||0,t.n=5;break;case 4:t.p=4,u=t.v,e.$message.error("加载失败: "+u.message);case 5:return t.p=5,e.loading=!1,t.f(5);case 6:return t.a(2)}}),t,null,[[1,4,5,6]])})))()},reset:function(){var e=this;this.form={id:void 0,name:void 0,price:0,stock:0},this.$nextTick((function(){e.$refs.form&&e.$refs.form.clearValidate()}))},handleAdd:function(){this.reset(),this.open=!0,this.title="添加商品"},handleUpdate:function(e){this.reset(),this.form=Object(i["a"])({},e),this.open=!0,this.title="修改商品"},cancel:function(){this.open=!1,this.reset()},submitForm:function(){var e=this;this.$refs["form"].validate(function(){var t=Object(o["a"])(Object(s["a"])().m((function t(r){var a,n,i,o,l;return Object(s["a"])().w((function(t){while(1)switch(t.p=t.n){case 0:if(!r){t.n=9;break}if(t.p=1,null==e.form.id){t.n=4;break}return t.n=2,c["a"].from("products").update({name:e.form.name,price:e.form.price,stock:e.form.stock}).eq("id",e.form.id);case 2:if(a=t.v,n=a.error,!n){t.n=3;break}throw n;case 3:e.$message.success("修改成功"),t.n=7;break;case 4:return t.n=5,c["a"].from("products").insert({name:e.form.name,price:e.form.price,stock:e.form.stock});case 5:if(i=t.v,o=i.error,!o){t.n=6;break}throw o;case 6:e.$message.success("新增成功");case 7:e.open=!1,e.getList(),t.n=9;break;case 8:t.p=8,l=t.v,e.$message.error("操作失败: "+l.message);case 9:return t.a(2)}}),t,null,[[1,8]])})));return function(e){return t.apply(this,arguments)}}())},handleDelete:function(e){var t=this;return Object(o["a"])(Object(s["a"])().m((function r(){return Object(s["a"])().w((function(r){while(1)switch(r.n){case 0:t.$confirm('是否确认删除商品名称为"'+e.name+'"的数据项？',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(Object(s["a"])().m((function r(){var a,n;return Object(s["a"])().w((function(r){while(1)switch(r.n){case 0:return r.n=1,c["a"].from("products").delete().eq("id",e.id);case 1:if(a=r.v,n=a.error,!n){r.n=2;break}throw n;case 2:t.$message.success("删除成功"),t.getList();case 3:return r.a(2)}}),r)})))).catch((function(e){"cancel"!==e&&t.$message.error("删除出错")}));case 1:return r.a(2)}}),r)})))()},parseTime:function(e){return e?e.replace("T"," ").substring(0,19):""}}},u=l,p=r("2877"),m=Object(p["a"])(u,a,n,!1,null,null,null);t["default"]=m.exports}}]);